<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./style.css">
    <title>トロフィー</title>
</head>
<body>
    <p>目標を入力してください</p>
    <div class="input_section">
        <div class="input_container1">
            <div>
                <label for="todo1">todo1：</label>
                <input type="text" id="todo1" name="todo1" placeholder="例)５時間勉強する">
            </div>
            <div>
                <label for="rate1">達成率：</label>
                <input type="number" id="rate1" name="todo1" min="0" max="100" step="1" placeholder="例)50"> %
            </div>
        </div>
    </div>
    <div>
        <input type="button" class="add" value="項目を追加する">
    </div>
    <div>
        <input type="submit" class="watch" value="達成率を見る">
    </div>
    <div class="result">
    </div>
<script
src="https://code.jquery.com/jquery-3.6.0.min.js"
integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
crossorigin="anonymous">
</script>


<script>

    console.log("現在のフォームの数：１");

    let formCount = 1;
    $(".add").click(function(){
        ++formCount;
        console.log("現在のフォームの数：" + formCount);

        let newForm = $(".input_container1").prop('outerHTML');
        newForm = newForm.replace(/1/g, formCount);
        $(".input_section").append(newForm);
    });

    $(".watch").click(function(){
        // console.log("pushed");
        $('.result').empty();


        const inputContainer = $("[class^='input_container']");
        const inputContainerCount = inputContainer.length;
        // console.log('要素の数：' + inputContainerCount);

        // １つずつフォームのhtml構造を取り出す
        console.log('==============');
        for (let i = 1; i <= inputContainerCount; i++) {
            
            // console.log(i);
            const todoId = `#todo${i}`;
            const rateId = `#rate${i}`;
            // console.log(todoId);

            const todoVal = $(todoId).val();
            const rateVal = $(rateId).val();
            console.log('task number' + i + ' : ' + todoVal);
            console.log('rate number' + i + ' : ' + rateVal);

            // 画面出力
            // $('.result').append('<div>' + todoVal + '</div>');
            $('.result').append(`<div>todo${i} : ${todoVal}</div>`);
            $('.result').append(`<div>rate : ${rateVal} %</div>`);


            console.log('==============');

        }
        
        // todo:値が入っていないときのバリデーション
        // todo:フォームの数を減らすボタン

    });

</script>
</body>
</html>